<% @loadQuestion = @questions.load %>
<div class="mt30">
	<div class="columns">
		<div class="column">
			<%= label_tag "総件数 " + @questions.total_count.to_s + " 件　" + (@questions.offset_value + 1).to_s + " 件 〜 " + (@questions.offset_value + @questions.length).to_s + " 件までを表示"%>
		</div>
		<div id="csv_button" class="column">
			<a href="javascript:document.forms[0].action = '/qs_list/outputCsv?format=csv'; document.forms[0].submit();"> <%= button_tag 'CSV出力', {:class => "button is-info is-small is-rounded", type: 'button'} %> </a>
			<%= button_tag 'CSV取込', {:type => "button", :id => "btnUpdCsv", :class => "button is-info is-small is-rounded", type: 'button'} %>
		</div>
	</div>
	<table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth mb30 parent_three_point_reader">
		<thead>
			<tr>
				<th style="width:15%">カテゴリ</th>
				<th style="width:20%">問題</th>
				<th style="width:20%">解答</th>
				<th style="width:15%">登録日時</th>
				<th style="width:20%"></th>
			</tr>
		</thead>
		<tbody>
			<% @loadQuestion.each do |question| %>
			<tr>
				<td class="categoryName child_three_point_reader tooltip" title="<%= question.category_name %>"><%= question.category_name %></td>
				<td class="question child_three_point_reader" title="<%= question.question %>"><%= question.question %></td>
				<td class="answer child_three_point_reader" title="<%= question.answer %>"><%= question.answer %></td>
				<td class="regDate"><%= question.reg_date %></td>
				<td class="updButton"><a href="/qs_upd/?question_id=<%= question.id %>" > <%= button_tag 'この問題を変更する', {:class => "button is-info is-small is-rounded"} %> </a></td>
			</tr>
			<% end %>
		</tbody>
	</table>
</div>
<%= paginate(@questions) %>
<div class="modal">
	<div class="modal-background"></div>
	<div class="modal-content">
		<input type="file" id="inpFile" name="inpFile" multiple>
		<p id="areaFile">
			このエリアに取込対象CSVファイルをドラッグ＆ドロップするか、
			<br>
			クリックして取込対象CSVファイルを選択してください
		</p>
		<div class="text-center mt40">
			<%= button_tag 'CSVアップロード実行', {:id => "btnExeFile" , :class => "button is-info is-small is-rounded", type: 'button'} %>
		</div>
	</div>
</div>
<script type="text/javascript">
	$("#btnUpdCsv").on("click", function() {
		$("div.modal").addClass("is-active");
	});
	$("div.modal-background").on("click", function() {
		$("div.modal").removeClass("is-active");
	});
	$("#inpFile").on("change", function() {
		if ($("#inpFile").val() != "") {
			$("#areaFile").html($("#inpFile").val() + "<br>上記をアップロードしてよろしければボタンを押してください");
		} else {
			$("#areaFile").html("このエリアに取込対象CSVファイルをドラッグ＆ドロップするか、<br>クリックして取込対象CSVファイルを選択してください");
		}
	});
	$("#btnExeFile").on("click", function() {
		document.forms[0].action = '/qs_list/uploadCsv';
		document.forms[0].enctype="multipart/form-data";
		document.forms[0].submit();
	});
</script>
